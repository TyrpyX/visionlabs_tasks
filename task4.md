Схема работы:
- Пользователь имеет доступ только к 'api gateway', на нем реализованы методы регистрации и авторизации,
а также прокси методы к сервисам RED и RED STATS. База, которую использует этот сервис может быть, например redis,
с ключом по емейлу пользователя, значением будет являться список хэша пароля и уникального айди пользователя.
- Сервис RED имеет один ендпоинт send_image, после вызова которого он определяет количество красного цвета
на картинке и отправляет сообщение в очередь со следующей информацией: айди пользователя, дата, количество красного,
айди картинки.
- Через очередь сообщение попадает в таск менеджер (доп. сервис реализован для того, чтобы уменьшить количество
работы сервиса RED, так как по условию он и так очень нагружен). Таск менеджер записывает в базу в таблицу images данные
о картинке, а также запрашивает из таблицы Subs данные о подписке пользователя, и если нужно отправляет ему сообщение.
Для этого , например, может быть поднят кластер postgres или clickhouse а хранение данных может быть шардировано, например
по айди пользователя.
- Сервис RED STATS имеет два эндпоинта: subscribe, get_stats. Первый записывает в табличку Subs, что пользователь
подписан и количество цвета, на которое он подписывается, также он забирает из базы Users email пользователя, также
с помощью данного метода можно отменить подписку.
Второй на основе таблиц Images и Subs выдает статистику за указанный временной промежуток, имет пагинацию.
- Масштабирование и оптимизация:
redis - репликация, горизонтальное масштабирование,
postgres/clickhouse - до определенного момента вертикальное масштабирование, индексы по user_id, оптимизация запросов,
ддалее - шардирование и горизонатльное масштабирование. 
